<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Finite Fields</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1 pagenumrestart">
<h2 id="chapter_finite_fields">Finite Fields</h2>
<div class="sectionbody">
<div class="paragraph lead">
<p>One of the most difficult things about learning how to program Bitcoin is knowing where to start.
There are so many components that depend on each other that learning one thing may lead you to have to learn another, which in turn may lead you to need to learn something else before you can understand the original thing.</p>
</div>
<div class="paragraph">
<p>This chapter is going to get you off to a more manageable start.
It may seem strange, but we&#8217;ll start with the basic math that you need to understand elliptic curve cryptography.
Elliptic curve cryptography, in turn, gives us the signing and verification algorithms.
These are at the heart of how transactions work, and transactions are the atomic unit of value transfer in Bitcoin.
By learning about finite fields and elliptic curves first, you&#8217;ll get a firm grasp of concepts that you&#8217;ll need to progress logically.</p>
</div>
<div class="paragraph">
<p>Be aware that this chapter and the next two chapters may feel a bit like you&#8217;re eating vegetables, especially if you haven&#8217;t done formal math in a long time.
I would encourage you to get through them, though, as the concepts and code presented here will be used throughout the book.</p>
</div>
<div class="sect2">
<h3 id="_learning_higher_level_math">Learning Higher-Level Math</h3>
<div class="paragraph">
<p>Learning about new mathematical structures can be a bit intimidating, and in this chapter, I hope to dispel the myth that high-level math is difficult.
Finite fields, in particular, don&#8217;t require all that much more in terms of prior mathematical knowledge than, say, algebra.</p>
</div>
<div class="paragraph">
<p>Think of finite fields as something that you could have learned instead of trigonometry, except that the education system you&#8217;re a part of decided that trigonometry was more important for you to learn.
This is my way of telling you that finite fields are not that hard to learn and require no more background than algebra.</p>
</div>
<div class="paragraph">
<p>This chapter is required if you want to understand elliptic curve cryptography.
Elliptic curve cryptography is required for understanding signing and verification, which is at the heart of Bitcoin itself.
As I&#8217;ve said, this chapter and the next two may feel a bit unrelated, but I encourage you to endure.
The fundamentals here will not only make understanding Bitcoin a lot easier, but also make understanding Schnorr signatures, confidential transactions, and other leading-edge Bitcoin technologies easier.</p>
</div>
</div>
<div class="sect2">
<h3 id="_finite_field_definition">Finite Field Definition</h3>
<div class="paragraph">
<p>Mathematically, a <em>finite field</em> is defined as a finite set of numbers and two operations <strong>+</strong> (addition) and <strong>⋅</strong> (multiplication) that satisfy the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <em>a</em> and <em>b</em> are in the set, <em>a + b</em> and <em>a</em> ⋅ <em>b</em> are in the set.
We call this property <em>closed</em>.</p>
</li>
<li>
<p>0 exists and has the property <em>a</em> + 0 = <em>a</em>. We call this the <em>additive identity</em>.</p>
</li>
<li>
<p>1 exists and has the property <em>a</em> ⋅ 1 = <em>a</em>. We call this the <em>multiplicative identity</em>.</p>
</li>
<li>
<p>If <em>a</em> is in the set, <em>–a</em> is in the set, which is defined as the value that makes <em>a</em> + (–<em>a</em>) = 0.
This is what we call the <em>additive inverse</em>.</p>
</li>
<li>
<p>If <em>a</em> is in the set and is not 0, <em>a</em><sup>–1</sup> is in the set, which is defined as the value that makes <em>a</em> ⋅ <em>a</em><sup>–1</sup> = 1.
This is what we call the <em>multiplicative inverse</em>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Let&#8217;s unpack each of these criteria.</p>
</div>
<div class="paragraph">
<p>We have a set of numbers that&#8217;s finite.
Because the set is finite, we can designate a number <em>p</em>, which is how big the set is.
This is what we call the <em>order</em> of the set.</p>
</div>
<div class="paragraph">
<p>#1 says we are closed under addition and multiplication.
This means that we have to define addition and multiplication in a way that ensures the results stay in the set.
For example, a set containing {0,1,2} is <em>not</em> closed under addition, since 1 + 2 = 3 and 3 is not in the set; neither is 2 + 2 = 4.
Of course we can define addition a little differently to make this work, but using "normal" addition, this set is not closed.
On the other hand, the set {–1,0,1} is closed under normal multiplication.
Any two numbers can be multiplied (there are nine such combinations), and the result is always in the set.</p>
</div>
<div class="paragraph">
<p>The other option we have in mathematics is to define multiplication in a particular way to make these sets closed.
We&#8217;ll get to how exactly we define addition and multiplication later in this chapter, but the key concept here is that we can <em>define addition and subtraction differently than the addition and subtraction you are familiar with</em>.</p>
</div>
<div class="paragraph">
<p>#2 and #3 mean that we have the additive and multiplicative identities.
That means 0 and 1 are in the set.</p>
</div>
<div class="paragraph">
<p>#4 means that we have the additive inverse.
That is, if <em>a</em> is in the set, <em>–a</em> is in the set.
Using the additive inverse, we can define subtraction.</p>
</div>
<div class="paragraph">
<p>#5 means that multiplication has the same property.
If <em>a</em> is in the set, <em>a</em><sup>–1</sup> is in the set.
That is <em>a</em> ⋅ <em>a</em><sup>–1</sup> = 1.
Using the multiplicative inverse, we can define division.
This will be the trickiest to define in a finite field.</p>
</div>
</div>
<div class="sect2">
<h3 id="_defining_finite_sets">Defining Finite Sets</h3>
<div class="paragraph">
<p>If the order (or size) of the set is <em>p</em>, we can call the elements of the set, 0, 1, 2, &#8230;&#8203; <em>p</em> – 1.
These numbers are what we call the <em>elements</em> of the set, not necessarily the traditional numbers 0, 1, 2, 3, etc.
They behave in many ways like traditional numbers, but have some differences in how we add, subtract, multiply, and so forth.</p>
</div>
<div class="paragraph">
<p>In math notation the finite field set looks like this:</p>
</div>
<ul class="simplelist">
<li><em>F</em><sub>p</sub> = {0, 1, 2, ... <em>p</em>–1}</li>
</ul>
<div class="paragraph">
<p>What&#8217;s in the finite field set are the elements.
<em>F</em><sub><em>p</em></sub> is a specific finite field called "field of <em>p</em>" or "field of 29" or whatever the size of it is (again, the size is what mathematicians call <em>order</em>).
The numbers between the {}s represent what elements are in the field.
We name the elements 0, 1, 2, etc. because these names are convenient for our purposes.</p>
</div>
<div class="paragraph">
<p>A finite field of order 11 looks like this:</p>
</div>
<ul class="simplelist">
<li><em>F</em><sub>11</sub> = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}</li>
</ul>
<div class="paragraph">
<p>A finite field of order 17 looks like this:</p>
</div>
<ul class="simplelist">
<li><em>F</em><sub>17</sub>= {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}</li>
</ul>
<div class="paragraph">
<p>A finite field of order 983 looks like this:</p>
</div>
<ul class="simplelist">
<li><em>F</em><sub>983</sub>= {0, 1, 2, ... 982}</li>
</ul>
<div class="paragraph">
<p>Notice the order of the field is always 1 more than the largest element.
You might have noticed that the field has a prime order every time.
For a variety of reasons that will become clear later, it turns out that fields <em>must</em> have an order that is a power of a prime, and that the finite fields whose order is prime are the ones we&#8217;re interested in.</p>
</div>
<div class="sect3">
<h4 id="_constructing_a_finite_field_in_python">Constructing a Finite Field in Python</h4>
<div class="paragraph">
<p>We want to represent each finite field element, so in Python, we&#8217;ll be creating a class that represents a single finite field element.
Naturally, we&#8217;ll name the class <span class="keep-together"><code>FieldElement</code></span>.</p>
</div>
<div class="paragraph">
<p>The class represents an element in a field <em>F</em><sub>prime</sub>.
The bare bones of the class look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class FieldElement:

    def __init__(self, num, prime):
        if num &gt;= prime or num &lt; 0:  # <b class="conum">(1)</b>
            error = 'Num {} not in field range 0 to {}'.format(
                num, prime - 1)
            raise ValueError(error)
        self.num = num  # <b class="conum">(2)</b>
        self.prime = prime

    def __repr__(self):
        return 'FieldElement_{}({})'.format(self.prime, self.num)

    def __eq__(self, other):
        if other is None:
            return False
        return self.num == other.num and self.prime == other.prime  # <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We first check that <code>num</code> is between <code>0</code> and <code>prime-1</code> inclusive.
If not, we get an invalid FieldElement and we raise a <code>ValueError</code>, which is what we should raise when we get an inappropriate value.</p>
</li>
<li>
<p>The rest of the <code><em>init</em></code> method assigns the initialization values to the object.</p>
</li>
<li>
<p>The <code><em>eq</em></code> method checks if two objects of class <code>FieldElement</code> are equal.
This is only true when the <code>num</code> and <code>prime</code> properties are equal.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>What we&#8217;ve defined already allows us to do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import FieldElement
&gt;&gt;&gt; a = FieldElement(7, 13)
&gt;&gt;&gt; b = FieldElement(6, 13)
&gt;&gt;&gt; print(a == b)
False
&gt;&gt;&gt; print(a == a)
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>Python allows us to override the <code>==</code> operator on <code>FieldElement</code> with the <code><em>eq</em></code> method, which is something we&#8217;ll be taking advantage of going forward.</p>
</div>
<div class="paragraph">
<p>You can see this in action in the code that accompanies this book.
Once you&#8217;ve set up Jupyter Notebook (see <a href="#setting_up">[setting_up]</a>), you can navigate to <em>code-ch01/Chapter1.ipynb</em> and run the code to see the results.
For the next exercise, you&#8217;ll want to open up <em>ecc.py</em> by clicking the link in the Exercise 1 box.
If you get stuck, please remember that the answers to every exercise are in <a href="#appendix_solutions">[appendix_solutions]</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_1">Exercise 1</h4>
<div class="paragraph">
<p>Write the corresponding method <code><em>ne</em></code>, which checks if two <code>FieldElement</code> objects are <em>not equal</em> to each other.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modulo_arithmetic">Modulo Arithmetic</h3>
<div class="paragraph">
<p>One of the tools we can use to make a finite field closed under addition, subtraction, multiplication, and division is something called <em>modulo arithmetic</em>.</p>
</div>
<div class="paragraph">
<p>We can define addition on the finite set using modulo arithmetic, which is something you probably learned when you first learned division.
Remember problems like the one in <a href="#long_division_example_one">Long division example 1</a>?</p>
</div>
<div id="long_division_example_one" class="imageblock">
<div class="content">
<img src="images/prbc_0101.png" alt="Long Division Example 1">
</div>
<div class="title">Figure 1. Long division example 1</div>
</div>
<div class="paragraph">
<p>Whenever the division wasn&#8217;t even, there was something called the "remainder," which is the amount left over from the actual division.
We define modulo in the same way.
We use the operator % for modulo:</p>
</div>
<ul class="simplelist">
<li>7 % 3 = 1</li>
</ul>
<div class="paragraph">
<p><a href="#long_division_example_two">Long division example 2</a> shows another example.</p>
</div>
<div id="long_division_example_two" class="imageblock">
<div class="content">
<img src="images/prbc_0102.png" alt="Long Division Example 2">
</div>
<div class="title">Figure 2. Long division example 2</div>
</div>
<div class="paragraph">
<p>Formally speaking, the modulo operation is the remainder after division of one number by another.
Let&#8217;s look at another example with larger numbers:</p>
</div>
<ul class="simplelist">
<li>1747 % 241 = 60</li>
</ul>
<div class="paragraph pagebreak-before">
<p>If it helps, you can think of modulo arithmetic as "wraparound" or "clock" math.
Imagine a problem like this:</p>
</div>
<ul class="simplelist">
<li>It is currently 3 o'clock. What hour will it be 47 hours from now?</li>
</ul>
<div class="paragraph">
<p>The answer is 2 o&#8217;clock because (3 + 47) % 12 = 2 (see <a href="#clock_going_forward_47_hours">Clock going forward 47 hours</a>).</p>
</div>
<div id="clock_going_forward_47_hours" class="imageblock">
<div class="content">
<img src="images/prbc_0103.png" alt="Clock">
</div>
<div class="title">Figure 3. Clock going forward 47 hours</div>
</div>
<div class="paragraph">
<p>We can also see this as "wrapping around" in the sense that we go past 0 every time we move ahead 12 hours.</p>
</div>
<div class="paragraph">
<p>We can perform modulo on negative numbers.
For example, you can ask:</p>
</div>
<ul class="simplelist">
<li>It is currently 3 o'clock.
What hour was it 16 hours ago?</li>
</ul>
<div class="paragraph">
<p>The answer is 11 o&#8217;clock:</p>
</div>
<ul class="simplelist">
<li>(3 – 16) % 12 = 11</li>
</ul>
<div class="paragraph">
<p>The minute hand is also a modulo operation.
For example, you can ask:</p>
</div>
<ul class="simplelist">
<li>It is currently 12 minutes past the hour.
What minute will it be 843 minutes from now?</li>
</ul>
<div class="paragraph">
<p>It will be 15 minutes past the hour:</p>
</div>
<ul class="simplelist">
<li>(12 + 843) % 60 = 15</li>
</ul>
<div class="paragraph">
<p>Likewise, we can ask:</p>
</div>
<ul class="simplelist">
<li>It is currently 23 minutes past the hour.
What minute will it be 97 minutes from now?</li>
</ul>
<div class="paragraph">
<p>In this case, the answer is 0:</p>
</div>
<ul class="simplelist">
<li>(23 + 97) % 60 = 0</li>
</ul>
<div class="paragraph">
<p>0 is another way of saying there is no remainder.</p>
</div>
<div class="paragraph">
<p>The result of the modulo (%) operation for minutes is always between 0 and 59, inclusive.
This happens to be a very useful property as even very large numbers can be brought down to a relatively small range with modulo:</p>
</div>
<ul class="simplelist">
<li>14738495684013 % 60 = 33</li>
</ul>
<div class="paragraph">
<p>We&#8217;ll be using modulo as we define field arithmetic.
Most operations in finite fields use the modulo operator in some capacity.</p>
</div>
<div class="sect3">
<h4 id="_modulo_arithmetic_in_python">Modulo Arithmetic in Python</h4>
<div class="paragraph">
<p>Python uses the <code>%</code> operator for modulo arithmetic.
Here is how the modulo operator is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; print(7 % 3)
1</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also use the modulo operator on negative numbers, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; print(-27 % 13)
12</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_finite_field_addition_and_subtraction">Finite Field Addition and Subtraction</h3>
<div class="paragraph">
<p>Remember that we need to define finite field addition such that we ensure the result is still in the set.
That is, we want to make sure that addition in a finite field is <em>closed</em>.</p>
</div>
<div class="paragraph">
<p>We can use what we just learned, modulo arithmetic, to make addition closed.
Let&#8217;s say we have a finite field of 19:</p>
</div>
<ul class="simplelist">
<li><em>F</em><sub>19</sub> = {0, 1, 2, ... 18}</li>
</ul>
<div class="paragraph">
<p>where <em>a</em>, <em>b</em> ∈ <em>F</em><sub>19</sub>. Note that the symbol ∈ means "is an element of."
In our case, <em>a</em> and <em>b</em> are elements of <em>F</em><sub>19</sub>.</p>
</div>
<div class="paragraph">
<p>Addition being closed means:</p>
</div>
<ul class="simplelist">
<li><em>a</em>+<sub><em>f</em></sub>b ∈ F<sub>19</sub></li>
</ul>
<div class="paragraph">
<p>We denote finite field addition with +<sub><em>f</em></sub> to avoid confusion with normal integer addition, +.</p>
</div>
<div class="paragraph">
<p>If we utilize modulo arithmetic, we can guarantee this to be the case.
We can define <em>a</em>+<sub><em>f</em></sub><em>b</em> this way:</p>
</div>
<ul class="simplelist">
<li><em>a</em>+<sub><em>f</em></sub><em>b</em> = (<em>a</em> + <em>b</em>)%19</li>
</ul>
<div class="paragraph">
<p>For example:</p>
</div>
<ul class="simplelist">
<li>7+<sub><em>f</em></sub>8 = (7+8)%19 = 15</li>
<li>11+<sub><em>f</em></sub>17 = (11+17)%19 = 9</li>
</ul>
<div class="paragraph">
<p>and so on.</p>
</div>
<div class="paragraph">
<p>We take any two numbers in the set, add, and "wrap around" the end to get the sum.
We are creating our own addition operator here and the result is a bit unintuitive.
After all, 11+<sub><em>f</em></sub>17 = 9 just doesn&#8217;t look right because we&#8217;re not used to finite field addition.</p>
</div>
<div class="paragraph">
<p>More generally, we define field addition this way:</p>
</div>
<ul class="simplelist">
<li><em>a</em>+<sub><em>f</em></sub><em>b</em> = (<em>a</em> + <em>b</em>)%<em>p</em></li>
</ul>
<div class="paragraph">
<p>where <em>a</em>, <em>b</em> ∈ <em>F</em><sub><em>p</em></sub>.</p>
</div>
<div class="paragraph">
<p>We also define the additive inverse this way. <em>a</em> ∈ <em>F</em><sub><em>p</em></sub> implies that –<sub><em>f</em></sub><em>a</em> ∈ <em>F</em><sub><em>p</em></sub>:</p>
</div>
<ul class="simplelist">
<li>–<sub><em>f</em></sub><em>a</em> = (–<em>a</em>) % <em>p</em></li>
</ul>
<div class="paragraph">
<p>Again, for clarity, we use –<sub><em>f</em></sub> to distinguish field subtraction and negation from integer subtraction and negation.</p>
</div>
<div class="paragraph">
<p>In <em>F</em><sub>19</sub>:</p>
</div>
<ul class="simplelist">
<li>–<sub><em>f</em></sub>9 = (–9) % 19 = 10</li>
</ul>
<div class="paragraph">
<p>which means that:</p>
</div>
<ul class="simplelist">
<li>9+<sub><em>f</em></sub> 10 = 0</li>
</ul>
<div class="paragraph">
<p>And that turns out to be true.</p>
</div>
<div class="paragraph">
<p>Similarly, we can do field subtraction:</p>
</div>
<ul class="simplelist">
<li><em>a</em>–<sub><em>f</em></sub><em>b</em> = (<em>a</em> – <em>b</em>)%<em>p</em></li>
</ul>
<div class="paragraph">
<p>where <em>a</em>, <em>b</em> ∈ <em>F</em><sub><em>p</em></sub>.</p>
</div>
<div class="paragraph">
<p>In <em>F</em><sub>19</sub>:</p>
</div>
<ul class="simplelist">
<li>11–<sub><em>f</em></sub>9=(11-9)%19 = 2</li>
<li>6–<sub><em>f</em></sub>13=(6-13)%19 = 12</li>
</ul>
<div class="paragraph">
<p>and so on.</p>
</div>
<div class="sect3">
<h4 id="_exercise_2">Exercise 2</h4>
<div class="paragraph">
<p>Solve these problems in <em>F</em><sub>57</sub> (assume all +'s here are +<sub><em>f</em></sub> and –'s here are –<sub><em>f</em></sub>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>44 + 33</p>
</li>
<li>
<p>9 – 29</p>
</li>
<li>
<p>17 + 42 + 49</p>
</li>
<li>
<p>52 – 30 – 38</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_coding_addition_and_subtraction_in_python">Coding Addition and Subtraction in Python</h4>
<div class="paragraph">
<p>In the class <code>FieldElement</code> we can now define <code><em>add</em></code> and <code><em>sub</em></code> methods.
The idea of these methods is that we want something like this to work:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import FieldElement
&gt;&gt;&gt; a = FieldElement(7, 13)
&gt;&gt;&gt; b = FieldElement(12, 13)
&gt;&gt;&gt; c = FieldElement(6, 13)
&gt;&gt;&gt; print(a+b==c)
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Python we can define what addition (or the + operator) means for our class with the <code><em>add</em></code> method.
So how do we do this?
We combine what we learned with modulo arithmetic and create a new method of the class <code>FieldElement</code> like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">    def __add__(self, other):
        if self.prime != other.prime:  # <b class="conum">(1)</b>
            raise TypeError('Cannot add two numbers in different Fields')
        num = (self.num + other.num) % self.prime  # <b class="conum">(2)</b>
        return self.__class__(num, self.prime)  # <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We have to ensure that the elements are from the same finite field, otherwise this calculation doesn&#8217;t have any meaning.</p>
</li>
<li>
<p>Addition in a finite field is defined with the modulo operator, as explained earlier.</p>
</li>
<li>
<p>We have to return an instance of the class, which we can conveniently access with <code>self.<em>class</em></code>.
We pass the two initializing arguments, <code>num</code> and <code>self.prime</code>, for the <code><em>init</em></code> method we saw earlier.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that we could use <code>FieldElement</code> instead of <code>self.<em>class</em></code>, but this would not make the method easily inheritable.
We will be subclassing <code>FieldElement</code> later, so making the method inheritable is important here.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_3">Exercise 3</h4>
<div class="paragraph">
<p>Write the corresponding <code><em>sub</em></code> method that defines the subtraction of two <span class="keep-together"><code>FieldElement</code></span> objects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_finite_field_multiplication_and_exponentiation">Finite Field Multiplication and Exponentiation</h3>
<div class="paragraph">
<p>Just as we defined a new addition (+<sub><em>f</em></sub>) for finite fields that was closed, we can also define a new multiplication for finite fields that&#8217;s closed.
By multiplying the same number many times, we can also define exponentiation.
In this section, we&#8217;ll go through exactly how to define this using modulo arithmetic.</p>
</div>
<div class="paragraph">
<p>Multiplication is adding multiple times:</p>
</div>
<ul class="simplelist">
<li>5 ⋅ 3 = 5 + 5 + 5 = 15</li>
<li>8 ⋅ 17 = 8 + 8 + 8 + ... (17 total 8's) ... + 8 = 136</li>
</ul>
<div class="paragraph">
<p>We can define multiplication on a finite field the same way.
Operating in <em>F</em><sub>19</sub> once again:</p>
</div>
<ul class="simplelist">
<li>5 ⋅<sub><em>f</em></sub> 3 = 5 +<sub><em>f</em></sub> 5 +<sub><em>f</em></sub> 5</li>
<li>8 ⋅<sub><em>f</em></sub> 17 = 8 +<sub><em>f</em></sub> 8 +<sub><em>f</em></sub> 8 +<sub><em>f</em></sub> ... (17 total 8's) ... +<sub><em>f</em></sub> 8</li>
</ul>
<div class="paragraph">
<p>We already know how to do the right side, and that yields a number within the <em>F</em><sub>19</sub> set:</p>
</div>
<ul class="simplelist">
<li>5 ⋅<sub><em>f</em></sub> 3 = 5 +<sub><em>f</em></sub> 5 +<sub><em>f</em></sub> 5 = 15 % 19 = 15</li>
<li>8 ⋅<sub><em>f</em></sub> 17 = 8 +<sub><em>f</em></sub> 8 +<sub><em>f</em></sub> 8 +<sub><em>f</em></sub> ... (17 total 8's) ... +<sub><em>f</em></sub> 8 = (8⋅17) % 19 = 136 % 19 = 3</li>
</ul>
<div class="paragraph">
<p>Note that the second result is pretty unintuitive.
We don&#8217;t normally think of 8 ⋅<sub><em>f</em></sub> 17 = 3, but that&#8217;s part of what&#8217;s necessary in order to define multiplication to be closed.
That is, the result of field multiplication is always in the set {0, 1, &#8230;&#8203; <em>p</em>–1}.</p>
</div>
<div class="paragraph">
<p>Exponentiation is simply multiplying a number many times:</p>
</div>
<ul class="simplelist">
<li>7<sup>3</sup>=7⋅<sub><em>f</em></sub>7⋅<sub><em>f</em></sub>7 = 343</li>
</ul>
<div class="paragraph">
<p>In a finite field, we can do exponentiation using modulo arithmetic.</p>
</div>
<div class="paragraph">
<p>In <em>F</em><sub>19</sub>:</p>
</div>
<ul class="simplelist">
<li>7<sup>3</sup> = 343 % 19=1</li>
<li>9<sup>12</sup> = 7</li>
</ul>
<div class="paragraph">
<p>Exponentiation again gives us counterintuitive results.
We don&#8217;t normally think 7<sup>3</sup> = 1 or 9<sup>12</sup> = 7.
Again, finite fields have to be defined so that the operations <em>always</em> result in a number within the field.</p>
</div>
<div class="sect3">
<h4 id="_exercise_4">Exercise 4</h4>
<div class="paragraph">
<p>Solve the following equations in <em>F</em><sub>97</sub> (again, assume ⋅ and exponentiation are field <span class="keep-together">versions</span>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>95 ⋅ 45 ⋅ 31</p>
</li>
<li>
<p>17 ⋅ 13 ⋅ 19 ⋅ 44</p>
</li>
<li>
<p>12<sup>7</sup> ⋅ 77<sup>49</sup></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_5">Exercise 5</h4>
<div class="paragraph">
<p>For <em>k</em> = 1, 3, 7, 13, 18, what is this set in <em>F</em><sub>19</sub>?</p>
</div>
<ul class="simplelist">
<li>{<em>k</em> ⋅ 0, <em>k</em> ⋅ 1, <em>k</em> ⋅ 2, <em>k</em> ⋅ 3, ... <em>k</em> ⋅ 18}</li>
</ul>
<div class="paragraph">
<p>Do you notice anything about these sets?</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Why Prime Fields are Useful</div>
<div class="paragraph">
<p>The answer to Exercise 5 is why we choose to use finite fields with a <em>prime</em> number of elements.
No matter what <em>k</em> you choose, as long as it&#8217;s greater than 0, multiplying the entire set by <em>k</em> will result in the same set as you started with.</p>
</div>
<div class="paragraph">
<p>Intuitively, the fact that we have a prime order results in every element of a finite field being equivalent.
If the order of the set was a composite number, multiplying the set by one of the divisors would result in a smaller set.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_coding_multiplication_in_python">Coding Multiplication in Python</h4>
<div class="paragraph">
<p>Now that we understand what multiplication should be in <code>FieldElement</code>, we want to define the <code><em>mul</em></code> method that overrides the <code>*</code> operator.
We want this to work:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import FieldElement
&gt;&gt;&gt; a = FieldElement(3, 13)
&gt;&gt;&gt; b = FieldElement(12, 13)
&gt;&gt;&gt; c = FieldElement(10, 13)
&gt;&gt;&gt; print(a*b==c)
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with addition and subtraction, the next exercise is to make multiplication work for our class by defining the <code><em>mul</em></code> method.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_6">Exercise 6</h4>
<div class="paragraph">
<p>Write the corresponding <code><em>mul</em></code> method that defines the multiplication of two finite field elements.</p>
</div>
</div>
<div class="sect3">
<h4 id="_coding_exponentiation_in_python">Coding Exponentiation in Python</h4>
<div class="paragraph">
<p>We need to define the exponentiation for <code>FieldElement</code>, which in Python can be defined with the <code><em>pow</em></code> method, overriding the <code>**</code> operator.
The difference here is that the exponent is <em>not</em> a <code>FieldElement</code>, so it has to be treated a bit differently.
We want something like this to work:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import FieldElement
&gt;&gt;&gt; a = FieldElement(3, 13)
&gt;&gt;&gt; b = FieldElement(1, 13)
&gt;&gt;&gt; print(a**3==b)
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that because the exponent is an integer, instead of another instance of <code>FieldElement</code>, the method receives the variable <code>exponent</code> as an integer.
We can code it this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class FieldElement:
...
    def __pow__(self, exponent):
        num = (self.num ** exponent) % self.prime  # <b class="conum">(1)</b>
        return self.__class__(num, self.prime)  # <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This is a perfectly fine way to do it, but <code>pow(self.num, exponent, self.prime)</code> is more efficient.</p>
</li>
<li>
<p>We have to return an instance of the class as before.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Why don&#8217;t we force the exponent to be a <code>FieldElement</code> object?
It turns out that the exponent doesn&#8217;t have to be a member of the finite field for the math to work.
In fact, if it were, the exponents wouldn&#8217;t display the intuitive behavior we expect, like being able to add the exponents when we multiply with the same base.</p>
</div>
<div class="paragraph">
<p>Some of what we&#8217;re doing now may seem slow for large numbers, but we&#8217;ll use some clever tricks to improve the performance of these algorithms.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_7">Exercise 7</h4>
<div class="paragraph">
<p>For <em>p</em> = 7, 11, 17, 31, what is this set in <em>F<sub>p</sub></em>?</p>
</div>
<ul class="simplelist">
<li>{1<sup>(<em>p</em> – 1)</sup>, 2<sup>(<em>p</em> – 1)</sup>, 3<sup>(<em>p</em> – 1)</sup>, 4<sup>(<em>p</em> – 1)</sup>, ... (<em>p</em> – 1)<sup>(<em>p</em> – 1)</sup>}</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_finite_field_division">Finite Field Division</h3>
<div class="paragraph">
<p>The intuition that helps us with addition, subtraction, multiplication, and perhaps even exponentiation unfortunately doesn&#8217;t help us quite as much with division.
Because division is the hardest operation to make sense of, we&#8217;ll start with something that should make sense.</p>
</div>
<div class="paragraph">
<p>In normal math, division is the inverse of multiplication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>7 ⋅ 8 = 56 implies that 56/8 = 7</p>
</li>
<li>
<p>12 ⋅ 2 = 24 implies that 24/12 = 2</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And so on.
We can use this as the definition of division to help us.
Note that like in normal math, you cannot divide by 0.</p>
</div>
<div class="paragraph">
<p>In <em>F</em><sub>19</sub>, we know that:</p>
</div>
<ul class="simplelist">
<li>3⋅<sub><em>f</em></sub>7 = 21%19 = 2 implies that 2/<sub><em>f</em></sub>7 = 3</li>
<li>9⋅<sub><em>f</em></sub>5 = 45%19 = 7 implies that 7/<sub><em>f</em></sub>5 = 9</li>
</ul>
<div class="paragraph">
<p>This is very unintuitive, as we generally think of 2/<sub><em>f</em></sub>7 or 7/<sub><em>f</em></sub>5 as fractions, not nice finite field elements.
Yet that is one of the remarkable things about finite fields: finite fields are <em>closed</em> under division.
That is, dividing any two numbers where the denominator is not 0 will result in another finite field element.</p>
</div>
<div class="paragraph">
<p>The question you might be asking yourself is, how do I calculate 2/<sub><em>f</em></sub>7 if I don&#8217;t know beforehand that 3⋅<sub><em>f</em></sub>7 = 2?
This is indeed a very good question; to answer it, we&#8217;ll have to use the result from Exercise 7.</p>
</div>
<div class="paragraph">
<p>In case you didn&#8217;t get it, the answer is that <em>n</em><sup>(<em>p</em>–1)</sup> is always 1 for every <em>p</em> that is prime and every <em>n</em> &gt; 0.
This is a beautiful result from number theory called Fermat&#8217;s little theorem.
Essentially, the theorem says:</p>
</div>
<ul class="simplelist">
<li><em>n</em><sup>(<em>p</em>–1)</sup>%<em>p</em> = 1 </li>
</ul>
<div class="paragraph">
<p>where <em>p</em> is prime.</p>
</div>
<div class="paragraph">
<p>Since we are operating in prime fields, this will always be true.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Fermat&#8217;s Little Theorem</div>
<div class="paragraph">
<p>There are many proofs of this theorem, but perhaps the simplest is using what we saw in Exercise 5—namely, that these sets are equal:</p>
</div>
<ul class="simplelist">
<li>{1, 2, 3, ... <em>p</em>–2, <em>p</em>–1} = {<em>n</em>%<em>p</em>, 2<em>n</em>%<em>p</em>, 3<em>n</em>%<em>p</em> (<em>p</em>–2)<em>n</em>%<em>p</em>, (<em>p</em>–1)<em>n</em>%<em>p</em>}</li>
</ul>
<div class="paragraph">
<p>The resulting numbers might not be in the right order, but the same numbers are in both sets. We can then multiply every element in both sets to get this equality:</p>
</div>
<ul class="simplelist">
<li>1 ⋅ 2 ⋅ 3 ⋅ ... ⋅ (<em>p</em>–2) ⋅ (<em>p</em>–1) % <em>p</em> = <em>n</em> ⋅ 2<em>n</em> ⋅ 3<em>n</em> ⋅ ... ⋅ (<em>p</em>–2)<em>n</em> ⋅ (<em>p</em>–1)<em>n</em> % <em>p</em></li>
</ul>
<div class="paragraph">
<p>The left side is the same as (<em>p</em>–1)! % <em>p</em> where ! is the factorial (e.g.,
5! = 5 ⋅ 4 ⋅ 3 ⋅ 2 ⋅ 1). On the right side, we can gather up all the <em>n</em>&#8217;s and get:</p>
</div>
<ul class="simplelist">
<li>(<em>p</em>–1)! ⋅ <em>n</em><sup>(p–1)</sup> % <em>p</em></li>
</ul>
<div class="paragraph">
<p>Thus:</p>
</div>
<ul class="simplelist">
<li>(<em>p</em>–1)! % <em>p</em> = (<em>p</em>–1)! ⋅ <em>n</em><sup>(p–1)</sup> % <em>p</em></li>
</ul>
<div class="paragraph">
<p>The (<em>p</em>–1)! on both sides cancel, giving us:</p>
</div>
<ul class="simplelist">
<li>1 = <em>n</em><sup>(p–1)</sup> % <em>p</em></li>
</ul>
<div class="paragraph">
<p>This proves Fermat&#8217;s little theorem.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Because division is the inverse of multiplication, we know:</p>
</div>
<ul class="simplelist">
<li><em>a</em>/<em>b</em> = <em>a</em>⋅<sub><em>f</em></sub>(1/<em>b</em>) = <em>a</em>⋅<sub><em>f</em></sub><em>b</em><sup>–1</sup></li>
</ul>
<div class="paragraph">
<p>We can reduce the division problem to a multiplication problem as long as we can figure out what <em>b</em><sup>–1</sup> is.
This is where Fermat&#8217;s little theorem comes into play.
We know:</p>
</div>
<ul class="simplelist">
<li><em>b</em><sup>(<em>p</em>–1)</sup> = 1</li>
</ul>
<div class="paragraph">
<p>because <em>p</em> is prime. Thus:</p>
</div>
<ul class="simplelist">
<li><em>b</em><sup>–1</sup> = <em>b</em><sup>–1</sup>⋅<sub><em>f</em></sub>1=<em>b</em><sup>–1</sup>⋅<sub><em>f</em></sub><em>b</em><sup>(<em>p</em>–1)</sup> = <em>b</em><sup>(<em>p</em>–2)</sup></li>
</ul>
<div class="paragraph">
<p>or:</p>
</div>
<ul class="simplelist">
<li><em>b</em><sup>–1</sup> = <em>b</em><sup>(<em>p</em>–2)</sup></li>
</ul>
<div class="paragraph">
<p>In <em>F</em><sub>19</sub>, this means practically that <em>b</em><sup>18</sup> = 1 , which means that <em>b</em><sup>–1</sup> = <em>b</em><sup>17</sup> for all <em>b</em> &gt; 0.</p>
</div>
<div class="paragraph">
<p>So in other words, we can calculate the inverse using the exponentiation operator.
In <em>F</em><sub>19</sub>:</p>
</div>
<ul class="simplelist">
<li>2/7 = 2⋅7<sup>(19 – 2)</sup> = 2⋅7<sup>17</sup>=465261027974414%19 = 3</li>
<li> 7/5 = 7⋅5<sup>(19 – 2)</sup> = 7⋅5<sup>17</sup>=5340576171875%19 = 9</li>
</ul>
<div class="paragraph">
<p>This is a relatively expensive calculation as exponentiating grows very fast.
Division is the most expensive operation for that reason.
To lessen the expense, we can use the <code>pow</code> function in Python, which does exponentiation.
In Python, <code>pow(7,17)</code> does the same thing as <code>7<strong>17</code>.
The <code>pow</code> function, however, has an optional third argument that makes our calculation more efficient.
Specifically, <code>pow</code> will modulo by the third argument.
Thus, <code>pow(7,17,19)</code> will give the same result as <code>7</strong>17%19</code> but do so faster because the modulo function is done after each round of multiplication.</p>
</div>
<div class="sect3">
<h4 id="_exercise_8">Exercise 8</h4>
<div class="paragraph">
<p>Solve the following equations in <em>F</em><sub>31</sub>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>3 / 24</p>
</li>
<li>
<p>17<sup>–3</sup></p>
</li>
<li>
<p>4<sup>–4</sup> ⋅ 11</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_9">Exercise 9</h4>
<div class="paragraph">
<p>Write the corresponding <code><em>truediv</em></code> method that defines the division of two field elements.</p>
</div>
<div class="paragraph">
<p>Note that in Python 3, division is separated into <code><em>truediv</em></code> and <code><em>floordiv</em></code>. The first does normal division and the second does integer division.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_redefining_exponentiation">Redefining Exponentiation</h3>
<div class="paragraph">
<p>One last thing that we need to take care of before we leave this chapter is the <code><em>pow</em></code> method, which needs to handle negative exponents.
For example, <em>a</em><sup>–3</sup> needs to be a finite field element, but the current code does not take care of this case.
We want, for example, something like this to work:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import FieldElement
&gt;&gt;&gt; a = FieldElement(7, 13)
&gt;&gt;&gt; b = FieldElement(8, 13)
&gt;&gt;&gt; print(a**-3==b)
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately, the way we&#8217;ve defined <code><em>pow</em></code> simply doesn&#8217;t handle negative exponents, because the second parameter of the built-in Python function <code>pow</code> is required to be positive.</p>
</div>
<div class="paragraph">
<p>Thankfully, we can use some math we already know to solve this. We know from <span class="keep-together">Fermat's</span> little theorem that:</p>
</div>
<ul class="simplelist">
<li><em>a</em><sup><em>p</em>–1</sup> = 1</li>
</ul>
<div class="paragraph">
<p>This fact means that we can multiply by <em>a</em><sup><em>p</em>–1</sup> as many times as we want.
So, for <em>a</em><sup>–3</sup>, we can do:</p>
</div>
<ul class="simplelist">
<li><em>a</em><sup>–3</sup> = <em>a</em><sup>–3</sup> ⋅ <em>a</em><sup><em>p</em>–1</sup> = <em>a</em><sup><em>p</em>–4</sup></li>
</ul>
<div class="paragraph">
<p>This is a way we can do negative exponents.
A naive implementation would do something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class FieldElement:
...
    def __pow__(self, exponent):
	n = exponent
	while n &lt; 0:
	    n += self.prime - 1 # <b class="conum">(1)</b>
        num = pow(self.num, n, self.prime) # <b class="conum">(2)</b>
        return self.__class__(num, self.prime)</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We add until we get a positive exponent.</p>
</li>
<li>
<p>We use the Python built-in <code>pow</code> to make this more efficient.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thankfully, we can do even better.
We already know how to force a number out of being negative, using our familiar friend <code>%</code>!
As a bonus, we can also reduce very large exponents at the same time given that <em>a</em><sup><em>p</em>–1</sup> = 1.
This will make the <code>pow</code> function not work as hard:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class FieldElement:
...
    def __pow__(self, exponent):
        n = exponent % (self.prime - 1)  # <b class="conum">(1)</b>
        num = pow(self.num, n, self.prime)
        return self.__class__(num, self.prime)</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Make the exponent into something within the 0 to <em>p</em>–2 range, inclusive.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>In this chapter we learned about finite fields and how to implement them in Python.
We&#8217;ll be using finite fields in <a href="#chapter_elliptic_curve_cryptography">[chapter_elliptic_curve_cryptography]</a> for elliptic curve cryptography.
We turn next to the other mathematical component that we need for elliptic curve cryptography: elliptic curves.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-11-22 19:07:17 -0600
</div>
</div>
</body>
</html>