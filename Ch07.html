<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Transaction Creation and Validation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="chapter_tx">Transaction Creation and Validation</h2>
<div class="sectionbody">
<div class="paragraph lead">
<p>One of the trickiest things to code in Bitcoin is validating transactions.
Another one is creating transactions.
In this chapter, we&#8217;ll cover the exact steps to do both.
Toward the end of the chapter, we&#8217;ll be creating a testnet transaction and broadcasting it.</p>
</div>
<div class="sect2">
<h3 id="_validating_transactions">Validating Transactions</h3>
<div class="paragraph">
<p>Every node, when receiving transactions, makes sure that each transaction adheres to the network rules.
This process is called <em>transaction validation</em>.
Here are the main things that a node checks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The inputs of the transaction are previously unspent.</p>
</li>
<li>
<p>The sum of the inputs is greater than or equal to the sum of the outputs.</p>
</li>
<li>
<p>The ScriptSig successfully unlocks the previous ScriptPubKey.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>#1 prevents double-spending.
Any input that&#8217;s been spent (that is, included in the blockchain) cannot be spent again.</p>
</div>
<div class="paragraph">
<p>#2 makes sure no new bitcoins are created (except in a special type of transaction called a coinbase transaction; more on that in <a href="#chapter_blocks">[chapter_blocks]</a>).</p>
</div>
<div class="paragraph">
<p>#3 makes sure that the combined script is valid.
In the vast majority of transactions, this means checking that the one or more signatures in the ScriptSig are valid.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at how each condition is checked.</p>
</div>
<div class="sect3 pagebreak-before">
<h4 id="_checking_the_spentness_of_inputs">Checking the Spentness of Inputs</h4>
<div class="paragraph">
<p>To prevent double-spending, a node checks that each input exists and has not been spent.
This can be checked by any full node by looking at the UTXO set (see <a href="#chapter_tx_parsing">[chapter_tx_parsing]</a>).
We cannot determine from the transaction itself whether it&#8217;s double-spending, much like we cannot look at a personal check and determine whether it&#8217;s overdrafting.
The only way to know is to have access to the UTXO set, which requires calculation from the entire set of transactions.</p>
</div>
<div class="paragraph">
<p>In Bitcoin, we can determine whether an input is being double-spent by keeping track of the UTXOs.
If an input is in the UTXO set, that transaction input both exists and is <em>not</em> double-spending.
If the transaction passes the rest of the validity tests, then we remove all the inputs of the transaction from the UTXO set.
Light clients that do not have access to the blockchain have to trust other nodes for a lot of the information, including whether an input has already been spent.</p>
</div>
<div class="paragraph">
<p>A full node can check the spentness of an input pretty easily, but a light client has to get this information from someone else.</p>
</div>
</div>
<div class="sect3">
<h4 id="_checking_the_sum_of_the_inputs_versus_the_sum_of_the_outputs">Checking the Sum of the Inputs Versus the Sum of the Outputs</h4>
<div class="paragraph">
<p>Nodes also make sure that the sum of the inputs is greater than or equal to the sum of the outputs.
This ensures that the transaction does not create new coins.
The one exception is a coinbase transaction, which we&#8217;ll study more in <a href="#chapter_blocks">[chapter_blocks]</a>.
Since inputs don&#8217;t have an amount field, this must be looked up on the blockchain.
Once again, full nodes have access to the amounts associated with the unspent output, but light clients have to depend on full nodes to supply this information.</p>
</div>
<div class="paragraph">
<p>We covered how to calculate fees in <a href="#chapter_tx_parsing">[chapter_tx_parsing]</a>.
Checking that the sum of the inputs is greater than or equal to the sum of the outputs is the same as checking that the fee is not negative (that is, creating money).
Recall the last exercise in <a href="#chapter_tx_parsing">[chapter_tx_parsing]</a>.
The method <code>fee</code> looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class Tx:
    ...
    def fee(self):
        '''Returns the fee of this transaction in satoshi'''
        input_sum, output_sum = 0, 0
        for tx_in in self.tx_ins:
            input_sum += tx_in.value(self.testnet)
        for tx_out in self.tx_outs:
            output_sum += tx_out.amount
        return input_sum - output_sum</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can test to see if this transaction is trying to create money by using this method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from tx import Tx
&gt;&gt;&gt; from io import BytesIO
&gt;&gt;&gt; raw_tx = ('0100000001813f79011acb80925dfe69b3def355fe914bd1d96a3f5f71bf830\
3c6a989c7d1000000006b483045022100ed81ff192e75a3fd2304004dcadb746fa5e24c5031ccf\
cf21320b0277457c98f02207a986d955c6e0cb35d446a89d3f56100f4d7f67801c31967743a9c8\
e10615bed01210349fc4e631e3624a545de3f89f5d8684c7b8138bd94bdd531d2e213bf016b278\
afeffffff02a135ef01000000001976a914bc3b654dca7e56b04dca18f2566cdaf02e8d9ada88a\
c99c39800000000001976a9141c4bc762dd5423e332166702cb75f40df79fea1288ac19430600')
&gt;&gt;&gt; stream = BytesIO(bytes.fromhex(raw_tx))
&gt;&gt;&gt; transaction = Tx.parse(stream)
&gt;&gt;&gt; print(transaction.fee() &gt;= 0)  # <b class="conum">(1)</b>
True</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This only works because we&#8217;re using Python (see <a href="#valueOverflow">The Value Overflow Incident</a>).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the fee is negative, we know that the <code>output_sum</code> is greater than the <code>input_sum</code>, which is another way of saying that this transaction is trying to create bitcoins out of the ether.</p>
</div>
<div id="valueOverflow" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">The Value Overflow Incident</div>
<div class="paragraph">
<p>Back in 2010, there was a transaction that created 184 billion new bitcoins.
This was due to the fact that in C++, the amount field is a <em>signed</em> integer and not an <em>unsigned</em> integer.
That is, the value could be negative!</p>
</div>
<div class="paragraph">
<p>The clever transaction passed all the checks, including the one for not creating new bitcoins, but only because the output amounts overflowed past the maximum number.
2<sup>64</sup> is ~1.84 &#215; 10<sup>19</sup> satoshis, which is 184 billion bitcoins.
The fee was negative by enough that the C++ code was tricked into believing that the fee was actually positive by 0.1 BTC!</p>
</div>
<div class="paragraph">
<p>The vulnerability is detailed in CVE-2010-5139 and was patched via a soft fork in Bitcoin Core 0.3.11.
The transaction and the extra bitcoins it created were invalidated retroactively by a block reorganization, which is another way of saying that the block including the value overflow transaction and all the blocks built on top of it were replaced.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_checking_the_signature">Checking the Signature</h4>
<div class="paragraph">
<p>Perhaps the trickiest part of validating a transaction is the process of checking its signatures.
A transaction typically has at least one signature per input.
If there are multisig outputs being spent, there may be more than one.
As we learned in <a href="#chapter_elliptic_curve_cryptography">[chapter_elliptic_curve_cryptography]</a>, the ECDSA signature algorithm requires the public key <em>P</em>, the signature hash <em>z</em>, and the signature (<em>r</em>,<em>s</em>).
Once these are known, the process of verifying the signature is pretty simple, as we already coded in <a href="#chapter_elliptic_curve_cryptography">[chapter_elliptic_curve_cryptography]</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import S256Point, Signature
&gt;&gt;&gt; sec = bytes.fromhex('0349fc4e631e3624a545de3f89f5d8684c7b8138bd94bdd531d2e\
213bf016b278a')
&gt;&gt;&gt; der = bytes.fromhex('3045022100ed81ff192e75a3fd2304004dcadb746fa5e24c5031c\
cfcf21320b0277457c98f02207a986d955c6e0cb35d446a89d3f56100f4d7f67801c31967743a9\
c8e10615bed')
&gt;&gt;&gt; z = 0x27e0c5994dec7824e56dec6b2fcb342eb7cdb0d0957c2fce9882f715e85d81a6
&gt;&gt;&gt; point = S256Point.parse(sec)
&gt;&gt;&gt; signature = Signature.parse(der)
&gt;&gt;&gt; print(point.verify(z, signature))
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>SEC public keys and DER signatures are in the stack when a command like <code>OP_CHECKSIG</code> is executed, making getting the public key and signature pretty straightforward (see <a href="#chapter_script">[chapter_script]</a>).
The hard part is getting the signature hash.
A naive way to do this would be to hash the transaction serialization as shown in <a href="#a_signature_is_in_the_yellow_highlighted_part_or_the_scriptsig">A signature is in the yellow highlighted part, or the ScriptSig</a>.
Unfortunately, we can&#8217;t do that, since the signature is part of the ScriptSig and a signature can&#8217;t sign itself.</p>
</div>
<div id="a_signature_is_in_the_yellow_highlighted_part_or_the_scriptsig" class="imageblock">
<div class="content">
<img src="images/prbc_0701.png" alt="Validation Start">
</div>
<div class="title">Figure 1. A signature is in the yellow highlighted part, or the ScriptSig</div>
</div>
<div class="paragraph">
<p>Instead, we modify the transaction before signing it.
That is, we compute a different signature hash <em>for each input</em>.
The procedure is as follows.</p>
</div>
<div class="sect4">
<h5 id="_step_1_empty_all_the_scriptsigs">Step 1: Empty all the ScriptSigs</h5>
<div class="paragraph">
<p>The first step is to empty all the ScriptSigs when checking the signature (<a href="#empty_each_inputs_scriptsig_in_yellow_highlighted_field">Empty each input&#8217;s ScriptSig (in yellow highlighted field, now 00)</a>).
The same procedure is used for creating the signature, except the ScriptSigs are usually already empty.</p>
</div>
<div id="empty_each_inputs_scriptsig_in_yellow_highlighted_field" class="imageblock">
<div class="content">
<img src="images/prbc_0702.png" alt="Validation Step 1">
</div>
<div class="title">Figure 2. Empty each input&#8217;s ScriptSig (in yellow highlighted field, now 00)</div>
</div>
<div class="paragraph">
<p>Note that this example has only one input, so only that input&#8217;s ScriptSig is emptied, but it&#8217;s possible to have more than one input. In that case, each of those would be emptied.</p>
</div>
</div>
<div class="sect4">
<h5 id="_step_2_replace_the_scriptsig_of_the_input_being_signed_with_the_previous_scriptpubkey">Step 2: Replace the ScriptSig of the input being signed with the previous ScriptPubKey</h5>
<div class="paragraph">
<p>Each input points to a previous transaction output, which has a ScriptPubKey. Recall the diagram from <a href="#chapter_script">[chapter_script]</a>, shown again in <a href="#scriptpubkey_and_scriptsig2">Combining the ScriptPubKey and ScriptSig</a>.</p>
</div>
<div id="scriptpubkey_and_scriptsig2" class="imageblock">
<div class="content">
<img src="images/prbc_0703.png" alt="ScriptPubKey and ScriptSig">
</div>
<div class="title">Figure 3. Combining the ScriptPubKey and ScriptSig</div>
</div>
<div class="paragraph">
<p>We take the ScriptPubKey that the input is pointing to and put that in place of the empty ScriptSig (<a href="#replace_the_scriptsig_yellow_highlighted_field_for_one_of_the_inputs_with_the_previous_scriptpubkey">Replace the ScriptSig (yellow highlighted field) for one of the inputs with the previous ScriptPubKey</a>).
This may require a lookup on the blockchain, but in practice the signer already knows the ScriptPubKey, as the input is one where the signer has the private key.</p>
</div>
<div id="replace_the_scriptsig_yellow_highlighted_field_for_one_of_the_inputs_with_the_previous_scriptpubkey" class="imageblock">
<div class="content">
<img src="images/prbc_0704.png" alt="Validation Step 2">
</div>
<div class="title">Figure 4. Replace the ScriptSig (yellow highlighted field) for one of the inputs with the previous ScriptPubKey</div>
</div>
</div>
<div class="sect4">
<h5 id="_step_3_append_the_hash_type">Step 3: Append the hash type</h5>
<div class="paragraph">
<p>Last, we add a 4-byte hash type to the end.
This is to specify what the signature is authorizing.
The signature can authorize this input to go with all the other inputs and outputs (<code>SIGHASH_ALL</code>), go with a specific output (<code>SIGHASH_SINGLE</code>), or go with any output whatsoever (<code>SIGHASH_NONE</code>).
The latter two have some theoretical use cases, but in practice, almost every transaction is signed with <code>SIGHASH_ALL</code>.
There&#8217;s also a rarely used hash type called <code>SIGHASH_ANYONECANPAY</code> that can be combined with any of the previous three, which we won&#8217;t get into here.
For <code>SIGHASH_ALL</code>, the final transaction must have the exact outputs that were signed or the input signature is invalid.</p>
</div>
<div class="paragraph">
<p>The integer corresponding to <code>SIGHASH_ALL</code> is 1 and this has to be encoded in little-endian over 4 bytes, which makes the modified transaction look like <a href="#append_the_hash_type_sighash_all_or_the_orange_01000000">Append the hash type (SIGHASH_ALL), or the brown 01000000</a>.</p>
</div>
<div id="append_the_hash_type_sighash_all_or_the_orange_01000000" class="imageblock">
<div class="content">
<img src="images/prbc_0705.png" alt="Validation Step 3">
</div>
<div class="title">Figure 5. Append the hash type (SIGHASH_ALL), or the brown 01000000</div>
</div>
<div class="paragraph">
<p>The hash256 of this modified transaction is interpreted as a big-endian integer to produce <em>z</em>.
The code for converting the modified transaction to <em>z</em> looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from helper import hash256
&gt;&gt;&gt; modified_tx = bytes.fromhex('0100000001813f79011acb80925dfe69b3def355fe914\
bd1d96a3f5f71bf8303c6a989c7d1000000001976a914a802fc56c704ce87c42d7c92eb75e7896\
bdc41ae88acfeffffff02a135ef01000000001976a914bc3b654dca7e56b04dca18f2566cdaf02\
e8d9ada88ac99c39800000000001976a9141c4bc762dd5423e332166702cb75f40df79fea1288a\
c1943060001000000')
&gt;&gt;&gt; h256 = hash256(modified_tx)
&gt;&gt;&gt; z = int.from_bytes(h256, 'big')
&gt;&gt;&gt; print(hex(z))
0x27e0c5994dec7824e56dec6b2fcb342eb7cdb0d0957c2fce9882f715e85d81a6</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have our <em>z</em>, we can take the public key in SEC format and the signature in DER format from the ScriptSig to verify the signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import S256Point, Signature
&gt;&gt;&gt; sec = bytes.fromhex('0349fc4e631e3624a545de3f89f5d8684c7b8138bd94bdd531d2e\
213bf016b278a')
&gt;&gt;&gt; der = bytes.fromhex('3045022100ed81ff192e75a3fd2304004dcadb746fa5e24c5031c\
cfcf21320b0277457c98f02207a986d955c6e0cb35d446a89d3f56100f4d7f67801c31967743a9\
c8e10615bed')
&gt;&gt;&gt; z = 0x27e0c5994dec7824e56dec6b2fcb342eb7cdb0d0957c2fce9882f715e85d81a6
&gt;&gt;&gt; point = S256Point.parse(sec)
&gt;&gt;&gt; signature = Signature.parse(der)
&gt;&gt;&gt; point.verify(z, signature)
True</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can code this transaction validation process into a method for <code>Tx</code>.
Thankfully, the Script engine can already handle signature verification (see <a href="#chapter_script">[chapter_script]</a>), so our task here is to glue everything together.
We need <em>z</em>, or the signature hash, to pass into the <code>evaluate</code> method and we need to combine the ScriptSig and ScriptPubKey.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Quadratic Hashing</div>
<div class="paragraph">
<p>The signature hashing algorithm is inefficient and wasteful.
The <em>quadratic hashing problem</em> states that time required to calculate the signature hashes increases quadratically with the number of inputs in a transaction.
Specifically, not only will the number of hash256 operations for calculating <em>z</em> increase on a per-input basis, but in addition, the length of the transaction will increase, slowing down each hash256 operation because the entire signature hash will need to be calculated anew for each input.</p>
</div>
<div class="paragraph">
<p>This was particularly obvious with the biggest transaction mined to date:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bb41a757f405890fb0f5856228e23b715702d714d59bf2b1feb70d8b2
b4e3e08</pre>
</div>
</div>
<div class="paragraph">
<p>This transaction had 5,569 inputs and 1 output and took many miners over a minute to validate, as the signature hashes for the transaction were expensive to calculate.</p>
</div>
<div class="paragraph">
<p>Segwit (<a href="#chapter_segwit">[chapter_segwit]</a>) fixes this with a different way of calculating the signature hash, which is specified in BIP0143.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_1">Exercise 1</h4>
<div class="paragraph">
<p>Write the <code>sig_hash</code> method for the <code>Tx</code> class.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_2">Exercise 2</h4>
<div class="paragraph">
<p>Write the <code>verify_input</code> method for the <code>Tx</code> class. You will want to use the <code>TxIn.script_pubkey</code>, <code>Tx.sig_hash</code>, and <code>Script.evaluate</code> methods.</p>
</div>
</div>
<div class="sect3">
<h4 id="_verifying_the_entire_transaction">Verifying the Entire Transaction</h4>
<div class="paragraph">
<p>Now that we can verify an input, the task of verifying the entire transaction is straightforward:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class Tx:
...
    def verify(self):
        '''Verify this transaction'''
        if self.fee() &lt; 0:  # <b class="conum">(1)</b>
            return False
        for i in range(len(self.tx_ins)):
            if not self.verify_input(i):  # <b class="conum">(2)</b>
                return False
        return True</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We make sure that we are not creating money.</p>
</li>
<li>
<p>We make sure that each input has a correct ScriptSig.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that a full node would verify more things, like checking for double-spends and checking some other consensus rules not discussed in this chapter (max sigops, size of ScriptSig, etc.), but this is good enough for our library.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_transactions">Creating Transactions</h3>
<div class="paragraph">
<p>The code to verify transactions will help quite a bit with creating transactions.
We can create transactions that fit the verification process.
Transactions we create will require the sum of the inputs to be greater than or equal to the sum of the outputs.
Similarly, transactions we create will require a ScriptSig that, when combined with the ScriptPubKey, will be valid.</p>
</div>
<div class="paragraph">
<p>To create a transaction, we need at least one output we&#8217;ve received.
That is, we need an output from the UTXO set whose ScriptPubKey we can unlock.
The vast majority of the time, we need one or more private keys corresponding to the public keys that are hashed in the ScriptPubKey.</p>
</div>
<div class="paragraph">
<p>The rest of this chapter will be concerned with creating a transaction whose inputs are locked by p2pkh ScriptPubKeys.</p>
</div>
<div class="sect3">
<h4 id="_constructing_the_transaction">Constructing the Transaction</h4>
<div class="paragraph">
<p>The construction of a transaction requires answering some basic questions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Where do we want the bitcoins to go?</p>
</li>
<li>
<p>What UTXOs can we spend?</p>
</li>
<li>
<p>How quickly do we want this transaction to get into the blockchain?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We&#8217;ll be using testnet for this example, though this can easily be applied to mainnet.</p>
</div>
<div class="paragraph">
<p>The first question is about how much we want to pay whom.
We can pay one or more addresses.
In this example, we will pay 0.1 testnet bitcoins (tBTC) to <code>mnrVtF8DWjMu839VW3rBfgYaAfKk8983Xf</code>.</p>
</div>
<div class="paragraph">
<p>The second question is about what&#8217;s in our wallet.
What do we have available to spend?
In this example, we have an output denoted by a transaction ID and output index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>0d6fe5213c0b3291f208cba8bfb59b7476dffacc4e5cb66f6eb20a080843a299:13</pre>
</div>
</div>
<div class="paragraph pagebreak-before">
<p>When we view this output on a testnet block explorer (<a href="#utxo_that_were_spending">UTXO that we&#8217;re spending</a>), we can see that our output is worth 0.44 tBTC.</p>
</div>
<div id="utxo_that_were_spending" class="imageblock">
<div class="content">
<img src="images/prbc_0706.png" alt="Transaction seen on the blockchain">
</div>
<div class="title">Figure 6. UTXO that we&#8217;re spending</div>
</div>
<div class="paragraph">
<p>Since this is more than 0.1 tBTC, we&#8217;ll want to send the rest back to ourselves.
Though it&#8217;s generally bad privacy and security practice to reuse addresses, we&#8217;ll send the bitcoins back to <code>mzx5YhAH9kNHtcN481u6WkjeHjYtVeKVh2</code> to make the transaction construction easier.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="title">Why Reusing Addresses Is a Bad Idea</div>
<div class="paragraph">
<p>Back in <a href="#chapter_script">[chapter_script]</a>, we went through how p2pk was inferior to p2pkh, in part because it was only protected by ECDSA.
p2pkh, on the other hand, is also protected by sha256 and ripemd160.
However, because the blockchain is public, once we spend from a ScriptPubKey corresponding to our address, we reveal our public key as part of the ScriptSig.
Once we&#8217;ve revealed that public key, sha256 and ripemd160 no longer protect us, as the attacker knows the public key and doesn&#8217;t have to guess it.</p>
</div>
<div class="paragraph">
<p>As of this writing, we are still protected by the discrete log problem, which is unlikely to be broken any time soon.
It&#8217;s important from a security perspective, however, to understand what we&#8217;re protected by.</p>
</div>
<div class="paragraph">
<p>The other reason to not reuse addresses is for privacy.
Having a single address for all our transactions means that people can link our transactions together.
If, for example, we bought something private (say, medication to treat some disease we don&#8217;t want others to know about) and spent another output with the same ScriptPubKey for a donation to some charity, the charity and the medication vendor could identify that we had done business with the other.</p>
</div>
<div class="paragraph">
<p>Privacy leaks tend to become security holes over time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The third question is really about fees.
If we want to get the transaction in the blockchain faster, we&#8217;ll have to pay more fees; if we don&#8217;t mind waiting, we can pay less.
In our case, we&#8217;ll use 0.01 tBTC as our fee.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Fee Estimation</div>
<div class="paragraph">
<p>Fee estimation is done on a per-byte basis.
If your transaction is 600 bytes, it will have double the fees as a transaction that&#8217;s 300 bytes.
This is because block space is limited and larger transactions take up more space.
This calculation has changed a bit since Segwit (see <a href="#chapter_segwit">[chapter_segwit]</a>), but the general principle still applies.
We want to pay enough on a per-byte basis so that miners are motivated to include our transaction as soon as possible.</p>
</div>
<div class="paragraph">
<p>When blocks aren&#8217;t full, almost any amount above the default relay limit (1 satoshi/byte) is enough to get a transaction included.
When blocks are full, this is not an easy thing to estimate.
There are multiple ways to estimate fees, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Looking at various fee levels and estimating the probability of inclusion based on past blocks and the mempools at the time</p>
</li>
<li>
<p>Looking at the current mempool and adding a fee that roughly corresponds to enough economic incentivization</p>
</li>
<li>
<p>Going with some fixed fee</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Many wallets use different strategies, and this is an active area of research.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_making_the_transaction">Making the Transaction</h4>
<div class="paragraph">
<p>We have a plan for a new transaction with one input and two outputs.
But first, let&#8217;s look at some other tools we&#8217;ll need.</p>
</div>
<div class="paragraph">
<p>We need a way to take an address and get the 20-byte hash out of it.
This is the opposite of encoding an address, so we call the function <code>decode_base58</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def decode_base58(s):
    num = 0
    for c in s:  # <b class="conum">(1)</b>
        num *= 58
        num += BASE58_ALPHABET.index(c)
    combined = num.to_bytes(25, byteorder='big')  # <b class="conum">(2)</b>
    checksum = combined[-4:]
    if hash256(combined[:-4])[:4] != checksum:
        raise ValueError('bad address: {} {}'.format(checksum, 
          hash256(combined[:-4])[:4]))
    return combined[1:-4]  # <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We get what number is encoded in this Base58 address.</p>
</li>
<li>
<p>Once we have the number, we convert it to big-endian bytes.</p>
</li>
<li>
<p>The first byte is the network prefix and the last 4 are the checksum.
The middle 20 are the actual 20-byte hash (aka hash160).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We also need a way to convert the 20-byte hash to a ScriptPubKey.
We call this function <code>p2pkh_script</code> since we&#8217;re converting the hash160 to a p2pkh:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def p2pkh_script(h160):
    '''Takes a hash160 and returns the p2pkh ScriptPubKey'''
    return Script([0x76, 0xa9, h160, 0x88, 0xac])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>0x76</code> is <code>OP_DUP</code>, <code>0xa9</code> is <code>OP_HASH160</code>, <code>h160</code> is a 20-byte element, <code>0x88</code> is <code>OP_EQUALVERIFY</code>, and <code>0xac</code> is <code>OP_CHECKSIG</code>.
This is the p2pkh ScriptPubKey command set from <a href="#chapter_script">[chapter_script]</a>.</p>
</div>
<div class="paragraph">
<p>Given these tools, we can proceed to transaction creation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-pycon" data-lang="pycon">&gt;&gt;&gt; from helper import decode_base58, SIGHASH_ALL
&gt;&gt;&gt; from script import p2pkh_script, Script
&gt;&gt;&gt; from tx import TxIn, TxOut, Tx
&gt;&gt;&gt; prev_tx = bytes.fromhex('0d6fe5213c0b3291f208cba8bfb59b7476dffacc4e5cb66f6\
eb20a080843a299')
&gt;&gt;&gt; prev_index = 13
&gt;&gt;&gt; tx_in = TxIn(prev_tx, prev_index)
&gt;&gt;&gt; tx_outs = []
&gt;&gt;&gt; change_amount = int(0.33*100000000)  # <b class="conum">(1)</b>
&gt;&gt;&gt; change_h160 = decode_base58('mzx5YhAH9kNHtcN481u6WkjeHjYtVeKVh2')
&gt;&gt;&gt; change_script = p2pkh_script(change_h160)
&gt;&gt;&gt; change_output = TxOut(amount=change_amount, script_pubkey=change_script)
&gt;&gt;&gt; target_amount = int(0.1*100000000)  # <b class="conum">(1)</b>
&gt;&gt;&gt; target_h160 = decode_base58('mnrVtF8DWjMu839VW3rBfgYaAfKk8983Xf')
&gt;&gt;&gt; target_script = p2pkh_script(target_h160)
&gt;&gt;&gt; target_output = TxOut(amount=target_amount, script_pubkey=target_script)
&gt;&gt;&gt; tx_obj = Tx(1, [tx_in], [change_output, target_output], 0, True)  # <b class="conum">(2)</b>
&gt;&gt;&gt; print(tx_obj)
tx: cd30a8da777d28ef0e61efe68a9f7c559c1d3e5bcd7b265c850ccb4068598d11
version: 1
tx_ins:
0d6fe5213c0b3291f208cba8bfb59b7476dffacc4e5cb66f6eb20a080843a299:13
tx_outs:
33000000:OP_DUP OP_HASH160 d52ad7ca9b3d096a38e752c2018e6fbc40cdf26f OP_EQUALVE\
RIFY OP_CHECKSIG
10000000:OP_DUP OP_HASH160 507b27411ccf7f16f10297de6cef3f291623eddf OP_EQUALVE\
RIFY OP_CHECKSIG
locktime: 0</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The amount must be in satoshis; given there are 100,000,000 satoshis per BTC, we have to multiply and cast to an integer.</p>
</li>
<li>
<p>We have to designate which network to look up using the <code>testnet=True</code> <span class="keep-together">argument</span>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We have created the actual transaction, but every ScriptSig in this transaction is currently empty. Filling it is where we turn next.</p>
</div>
</div>
<div class="sect3">
<h4 id="_signing_the_transaction">Signing the Transaction</h4>
<div class="paragraph">
<p>Signing the transaction could be tricky, but we know how to get the signature hash, <em>z</em>, from earlier in this chapter.
If we have the private key whose public key hash160s to the 20-byte hash in the ScriptPubKey, we can sign <em>z</em> and produce the DER signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-pycon" data-lang="pycon">&gt;&gt;&gt; from ecc import PrivateKey
&gt;&gt;&gt; from helper import SIGHASH_ALL
&gt;&gt;&gt; z = transaction.sig_hash(0)  # <b class="conum">(1)</b>
&gt;&gt;&gt; private_key = PrivateKey(secret=8675309)
&gt;&gt;&gt; der = private_key.sign(z).der()
&gt;&gt;&gt; sig = der + SIGHASH_ALL.to_bytes(1, 'big')  # <b class="conum">(2)</b>
&gt;&gt;&gt; sec = private_key.point.sec()
&gt;&gt;&gt; script_sig = Script([sig, sec])  # <b class="conum">(3)</b>
&gt;&gt;&gt; transaction.tx_ins[0].script_sig = script_sig   # <b class="conum">(4)</b>
&gt;&gt;&gt; print(transaction.serialize().hex())
0100000001813f79011acb80925dfe69b3def355fe914bd1d96a3f5f71bf8303c6a989c7d10000\
00006a47304402207db2402a3311a3b845b038885e3dd889c08126a8570f26a844e3e4049c482a\
11022010178cdca4129eacbeab7c44648bf5ac1f9cac217cd609d216ec2ebc8d242c0a01210393\
5581e52c354cd2f484fe8ed83af7a3097005b2f9c60bff71d35bd795f54b67feffffff02a135ef\
01000000001976a914bc3b654dca7e56b04dca18f2566cdaf02e8d9ada88ac99c3980000000000\
1976a9141c4bc762dd5423e332166702cb75f40df79fea1288ac19430600</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>We only need to sign the first inputthere&#8217;s only one.
Multiple inputs would require us to sign each input with the right private key.</p>
</li>
<li>
<p>The signature is actually a combination of the DER signature and the hash type, which is <code>SIGHASH_ALL</code> in our case.</p>
</li>
<li>
<p>The ScriptSig of a p2pkh has exactly two elements, as we saw in <a href="#chapter_script">[chapter_script]</a>: the signature and SEC format public key.</p>
</li>
<li>
<p>We only have one input that we need to sign, but if there were more, this process of creating the ScriptSig would need to be done for each input.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_3">Exercise 3</h4>
<div class="paragraph">
<p>Write the <code>sign_input</code> method for the <code>Tx</code> class.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_your_own_transactions_on_testnet">Creating Your Own Transactions on testnet</h3>
<div class="paragraph">
<p>To create your own transaction, get some coins for yourself.
To do that you&#8217;ll need an address.
If you completed the last exercise in <a href="#chapter_serialization">[chapter_serialization]</a>, you should have your own testnet address and private key.
If you don&#8217;t remember, here&#8217;s how:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">&gt;&gt;&gt; from ecc import PrivateKey
&gt;&gt;&gt; from helper import hash256, little_endian_to_int
&gt;&gt;&gt; secret = little_endian_to_int(hash256(b'Jimmy Song secret'))  # <b class="conum">(1)</b>
&gt;&gt;&gt; private_key = PrivateKey(secret)
&gt;&gt;&gt; print(private_key.point.address(testnet=True))
mn81594PzKZa9K3Jyy1ushpuEzrnTnxhVg</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Please use a phrase other than <code>Jimmy Song secret</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once you have an address, you can get some coins from one of the testnet faucets that provide free testnet coins for testing purposes.
You can Google "testnet bitcoin faucet" to find one, or use one from the <a href="https://en.bitcoin.it/wiki/Testnet#Faucets">list on the wiki</a>.
My website, <a href="https://faucet.programmingbitcoin.com" class="bare">https://faucet.programmingbitcoin.com</a>, is also updated to point to a testnet faucet that works.
Enter your new testnet address into any of these faucets to get some testnet coins.</p>
</div>
<div class="paragraph">
<p>After receiving some coins, spend them using this library.
This is a big accomplishment for a budding Bitcoin developer, so please take some time to complete these exercises.</p>
</div>
<div class="sect3">
<h4 id="_exercise_4">Exercise 4</h4>
<div class="paragraph">
<p>Create a testnet transaction that sends 60% of a single UTXO to <code>mwJn1YPMq7y5F8J3LkC5Hxg9PHyZ5K4cFv</code>. The remaining amount minus fees should go back to your own change address. This should be a one-input, two-output <span class="keep-together">transaction</span>.</p>
</div>
<div class="paragraph">
<p>You can broadcast the transaction at <a href="https://blockstream.info/testnet/tx/push" class="bare">https://blockstream.info/testnet/tx/push</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_5">Exercise 5</h4>
<div class="paragraph">
<p>Advanced: Get some more testnet coins from a testnet faucet and create a two-input, one-output transaction. One input should be from the faucet, the other should be from the previous exercise; the output can be your own address.</p>
</div>
<div class="paragraph">
<p>You can broadcast the transaction at <a href="https://blockstream.info/testnet/tx/push" class="bare">https://blockstream.info/testnet/tx/push</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>We&#8217;ve successfully validated existing transactions on the blockchain, and you&#8217;ve also created your own transactions on testnet!
This is a major achievement, and you should be proud.</p>
</div>
<div class="paragraph">
<p>The code we have so far will do p2pkh and p2pk.
In the next chapter, we turn to a more advanced smart contract, p2sh.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-11-22 19:07:17 -0600
</div>
</div>
</body>
</html>